(function(e){function t(t){for(var r,o,l=t[0],i=t[1],n=t[2],d=0,b=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&b.push(c[o][0]),c[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);u&&u(t);while(b.length)b.shift()();return a.push.apply(a,n||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],r=!0,l=1;l<s.length;l++){var i=s[l];0!==c[i]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=s[0]))}return e}var r={},c={app:0},a=[];function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(s,r,function(t){return e[t]}.bind(null,r));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var n=0;n<l.length;n++)t(l[n]);var u=i;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"56d7":function(e,t,s){"use strict";s.r(t);var r=s("7a23");const c={class:"ml-4 grid grid-row:3 grid-flow-col gap-4"},a={class:"row-span-full rounded-md bg-yellow-600 text-white font-semibold items-center py-3 px-6"},o={class:"row-span-full col-span-4 rounded-md border-2 border-yellow-600 py-3 px-6"};function l(e,t,s,l,i,n){const u=Object(r["w"])("Header"),d=Object(r["w"])("Sidebar"),b=Object(r["w"])("router-view");return Object(r["r"])(),Object(r["e"])(r["a"],null,[Object(r["h"])(u),Object(r["f"])("div",c,[Object(r["f"])("div",a,[Object(r["h"])(d)]),Object(r["f"])("div",o,[Object(r["h"])(b)])])],64)}const i={class:"text-center bg-yellow-600 text-white p-4 mb-8"},n=Object(r["f"])("div",{class:"text-3xl font-bold"},[Object(r["f"])("i",{class:"fas fa-link"},"Â "),Object(r["g"])("Dream CRM appli ")],-1),u=[n];function d(e,t,s,c,a,o){return Object(r["r"])(),Object(r["e"])("header",i,u)}var b={name:"Header"};b.render=d;var h=b;const m={class:"text-white"},f={class:"m-4"},p=Object(r["g"])("Home"),j={class:"m-4"},O=Object(r["g"])("Customer");function g(e,t,s,c,a,o){const l=Object(r["w"])("router-link");return Object(r["r"])(),Object(r["e"])("div",null,[Object(r["f"])("ul",m,[Object(r["f"])("li",f,[Object(r["h"])(l,{"active-class":"text-lg text-yellow-200",class:"hover:text-lg hover:text-yellow-200",to:"/"},{default:Object(r["E"])(()=>[p]),_:1})]),Object(r["f"])("li",j,[Object(r["h"])(l,{"active-class":"text-lg text-yellow-200",class:"hover:text-lg hover:text-yellow-200",to:"/customer"},{default:Object(r["E"])(()=>[O]),_:1})])])])}var y={name:"Sidebar"};y.render=g;var v=y,w={components:{Header:h,Sidebar:v},mounted(){}};w.render=l;var x=w,C=s("6c02");const k={class:"home"};function M(e,t,s,c,a,o){return Object(r["r"])(),Object(r["e"])("div",k," Hello World! ")}var E={name:"Home",components:{},created(){}};E.render=M;var A=E;const F={class:"relative mb-4"},S=Object(r["f"])("span",{class:"absolute inset-y-0 left-0 flex items-center pl-2"},[Object(r["f"])("svg",{fill:"none",stroke:"orange","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",class:"w-6 h-6"},[Object(r["f"])("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),_=Object(r["f"])("i",{class:"fas fa-plus-circle text-white mr-2"},null,-1),L=Object(r["g"])("Create a Customer "),D=[_,L],$={class:"inline-flex ml-2 mr-2 bg-yellow-600 text-white rounded-lg shadow-lg px-2 py-2 hover:bg-yellow-700"},H=Object(r["f"])("svg",{class:"animate-spin mr-2 h-auto w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[Object(r["f"])("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),Object(r["f"])("path",{class:"opacity-100",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),P=Object(r["g"])(" Loading... "),I=[H,P],q={class:"rounded-t-md shadow-lg overflow-hidden"},z={id:"customers"},V={class:"px-3 py-2"},B=["value"],U=["set"],T=["onClick"],G=["onClick"],J=["colspan"],N={key:0,class:"text-red-600"},R={class:"container"},Q=Object(r["g"])("Back to Customers List "),W={class:"mt-8 mb-6 grid grid-cols-3 gap-8"},K=["set"],X=["for"],Y=["required","id","value"],Z={class:"flex items-stretch"},ee=Object(r["f"])("button",{class:"rounded ml-4 px-2 py-1 text-gray-100 bg-blue-600 hover:bg-blue-700",type:"submit"},"Save and Quit",-1),te={key:1,class:"text-red-600"},se=Object(r["f"])("h3",{class:"text-yellow-800"},"Create a new Customer",-1),re={class:"mt-8 mb-6 grid grid-cols-3 gap-8"},ce=["for"],ae=["required","id"],oe=Object(r["f"])("button",{class:"rounded ml-4 px-2 py-1 text-gray-100 bg-yellow-600 hover:bg-yellow-700",type:"submit"},"Create",-1),le={key:2,class:"fixed overflow-x-hidden overflow-y-auto inset-0 z-20 flex justify-center items-center"},ie={class:"relative w-auto max-w-2xl"},ne={class:"bg-white w-full rounded shadow-xl flex flex-col"},ue=Object(r["f"])("div",{class:"py-2 px-2 font-semibold"},"Are you sure to delete this customer?",-1),de={class:"py-2 px-2 flex flex-row"},be={key:3,class:"absolute inset-0 z-10 opacity-25 bg-black"};function he(e,t,s,c,a,o){return Object(r["r"])(),Object(r["e"])(r["a"],null,[Object(r["F"])(Object(r["f"])("div",F,[S,Object(r["F"])(Object(r["f"])("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=e=>a.search=e),name:"q",class:Object(r["n"])([a.focusMedium,"py-2 text-sm rounded-md pl-10 text-gray-800 hover:border-yellow-600"]),placeholder:"Search",autocomplete:"off"},null,2),[[r["B"],a.search]]),Object(r["f"])("button",{onClick:t[1]||(t[1]=(...e)=>o.createCustomer&&o.createCustomer(...e)),class:"ml-2 mr-2 bg-yellow-600 text-white rounded-lg shadow-lg px-2 py-2 hover:bg-yellow-700"},D),Object(r["f"])("span",{class:Object(r["n"])([{invisible:!a.showMessage},"rounded border-l-4 bg-green-400 text-sm text-white px-2 py-3 border-green-800 shadow-xl items-center"])},[Object(r["g"])(Object(r["y"])(a.message),1),Object(r["f"])("i",{onClick:t[2]||(t[2]=e=>a.showMessage=!1),class:"ml-2 far fa-times-circle"})],2),Object(r["F"])(Object(r["f"])("button",$,I,512),[[r["C"],!a.loaded]])],512),[[r["C"],!a.edit&&!a.create]]),Object(r["F"])(Object(r["f"])("div",q,[Object(r["f"])("table",z,[Object(r["f"])("thead",null,[Object(r["f"])("tr",{class:Object(r["n"])([a.dark,"text-left text-white"])},[Object(r["f"])("th",{class:Object(r["n"])([a.medium,"px-3 py-2"])},[Object(r["F"])(Object(r["f"])("input",{type:"checkbox",onClick:t[3]||(t[3]=e=>o.checkAll()),"onUpdate:modelValue":t[4]||(t[4]=e=>a.isCheckAll=e)},null,512),[[r["A"],a.isCheckAll]])],2),(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["v"])(a.customersMeta,(e,t)=>(Object(r["r"])(),Object(r["e"])("th",{class:"px-3 py-2",key:t},Object(r["y"])(e[1]),1))),128)),Object(r["f"])("th",{colspan:"2",class:Object(r["n"])([a.medium,"px-3 py-2"])},null,2)],2)]),Object(r["f"])("tbody",null,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["v"])(o.filteredCustomers,(s,c)=>(Object(r["r"])(),Object(r["e"])("tr",{key:c},[Object(r["f"])("td",V,[Object(r["F"])(Object(r["f"])("input",{type:"checkbox",value:s._id,"onUpdate:modelValue":t[5]||(t[5]=e=>a.checkedItems=e),onChange:t[6]||(t[6]=e=>o.updateCheckAll())},null,40,B),[[r["A"],a.checkedItems]])]),(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["v"])(a.customersMeta,(t,c)=>(Object(r["r"])(),Object(r["e"])("td",{class:"px-3 py-2",key:c,set:e.custData=o.getMeta(t[0],s)},Object(r["y"])(e.custData),9,U))),128)),Object(r["f"])("td",{class:Object(r["n"])([a.light,"px-3 py-2"])},[Object(r["f"])("i",{onClick:e=>o.editCustomer(s),class:"fas fa-edit text-yellow-600",title:"edit"},null,8,T)],2),Object(r["f"])("td",{class:Object(r["n"])([a.light,"px-3 py-2"])},[Object(r["f"])("i",{onClick:e=>o.showCustomerModal(s),class:"fas fa-trash text-red-600",title:"delete"},null,8,G)],2)]))),128)),Object(r["f"])("tr",{class:Object(r["n"])([a.dark,"h-1"])},[Object(r["f"])("td",{colspan:a.customersMeta.length+3},null,8,J)],2)])])],512),[[r["C"],a.loaded&&!a.edit&&!a.create]]),a.updateErrorFlag&&a.edit?(Object(r["r"])(),Object(r["e"])("div",N,Object(r["y"])(a.updateError),1)):Object(r["d"])("",!0),Object(r["F"])(Object(r["f"])("div",R,[Object(r["f"])("div",{onClick:t[8]||(t[8]=(...e)=>o.cancelEdit&&o.cancelEdit(...e)),class:"text-yellow-800 cursor-pointer hover:font-semibold w-1/3"},[Q,Object(r["f"])("span",{class:Object(r["n"])([{invisible:!a.showMessage},"rounded border-l-4 bg-green-400 text-sm text-white px-2 py-3 border-green-800 shadow-xl items-center"])},[Object(r["g"])(Object(r["y"])(a.message),1),Object(r["f"])("i",{onClick:t[7]||(t[7]=e=>a.showMessage=!1),class:"ml-2 far fa-times-circle"})],2)]),Object(r["f"])("form",{name:"update",ref:"updateForm",onSubmit:t[11]||(t[11]=Object(r["G"])(e=>o.updateCust(!0),["prevent"]))},[Object(r["f"])("div",W,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["v"])(a.customersMeta,(t,s)=>(Object(r["r"])(),Object(r["e"])("div",{class:"",key:s,set:e.custData=o.getMeta(t[0],this.customer)},[Object(r["f"])("label",{for:"u_"+t[0],class:"block left-1 -top-2 text-gray-500 text-sm"},Object(r["y"])(t[1]),9,X),Object(r["f"])("input",{required:t[2],id:"u_"+t[0],class:Object(r["n"])([a.focusMedium,"py-2 text-sm rounded-md px-2 text-gray-800"]),ref:"u_"+o.getLastMeta(t[0]),value:e.custData},null,10,Y)],8,K))),128))]),Object(r["f"])("div",Z,[Object(r["f"])("button",{type:"reset",class:"rounded px-2 py-1 text-gray-100 bg-gray-500 hover:bg-gray-600",onClick:t[9]||(t[9]=(...e)=>o.cancelEdit&&o.cancelEdit(...e))},"Cancel"),Object(r["f"])("div",{class:"cursor-pointer rounded ml-4 px-2 py-1 text-gray-100 bg-yellow-600 hover:bg-yellow-700",onClick:t[10]||(t[10]=e=>o.updateCust(!1))},"Save"),ee])],544)],512),[[r["C"],a.edit]]),a.createErrorFlag&&a.create?(Object(r["r"])(),Object(r["e"])("div",te,Object(r["y"])(a.createError),1)):Object(r["d"])("",!0),Object(r["F"])(Object(r["f"])("div",null,[Object(r["f"])("form",{name:"create",ref:"create",onSubmit:t[13]||(t[13]=Object(r["G"])((...e)=>o.createCust&&o.createCust(...e),["prevent"]))},[se,Object(r["f"])("div",re,[(Object(r["r"])(!0),Object(r["e"])(r["a"],null,Object(r["v"])(a.customersMeta,(e,t)=>(Object(r["r"])(),Object(r["e"])("div",{class:"relative",key:t},[Object(r["f"])("label",{for:e[0],class:"block left-1 -top-2 text-gray-500 text-sm"},Object(r["y"])(e[1]),9,ce),Object(r["f"])("input",{required:e[2],id:e[0],class:Object(r["n"])([a.focusMedium,"py-2 text-sm rounded-md px-2 text-gray-800"]),ref:o.getLastMeta(e[0])},null,10,ae)]))),128))]),Object(r["f"])("button",{type:"reset",class:"rounded px-2 py-1 text-gray-100 bg-gray-500 hover:bg-gray-600",onClick:t[12]||(t[12]=(...e)=>o.cancelCreate&&o.cancelCreate(...e))},"Cancel"),oe],544)],512),[[r["C"],a.create]]),a.showModal?(Object(r["r"])(),Object(r["e"])("div",le,[Object(r["f"])("div",ie,[Object(r["f"])("div",ne,[Object(r["f"])("div",{class:Object(r["n"])([a.dark,"text-right text-white px-1 py-1"])},[Object(r["f"])("i",{class:"far fa-times-circle",onClick:t[14]||(t[14]=(...e)=>o.cancel&&o.cancel(...e))})],2),ue,Object(r["f"])("div",de,[Object(r["f"])("button",{class:"rounded bg-gray-400 text-white px-2 mt-1 py-2 w-1/3 m-auto mb-2",onClick:t[15]||(t[15]=(...e)=>o.cancel&&o.cancel(...e)),type:"button"}," Cancel "),Object(r["f"])("button",{class:"rounded bg-red-600 text-white px-2 mt-1 py-2 w-1/3 m-auto mb-2",onClick:t[16]||(t[16]=e=>o.deleteCust(this.customer._id)),type:"button"}," Delete ")])])])])):Object(r["d"])("",!0),a.showModal?(Object(r["r"])(),Object(r["e"])("div",be)):Object(r["d"])("",!0)],64)}var me=s("bc3a"),fe=s.n(me);const pe="http://localhost:5000/customers",je="http://localhost:5000/customers/meta";console.log("CustomerService.js URL : "+pe),console.log("CustomerService.js NODE_ENV : production");class Oe{static async getCustomersMeta(){try{const e=await fe.a.get(je);return e.data}catch(e){return console.log("CustomerService getCustomersMeta error : "+e),e}}static async getCustomers(){try{const e=await fe.a.get(pe);return e.data}catch(e){return console.log("CustomerService getCustomers error : "+e),e}}static async getCustomer(e){try{const t=await fe.a.get(`${pe}/${e}`);return t.data}catch(t){return console.log("CustomerService getCustomers error : "+t),t}}static insertCustomer(e){return fe.a.post(pe,e)}static updateCustomer(e,t){return fe.a.put(`${pe}/${e}`,t)}static deleteCustomer(e){return fe.a.delete(`${pe}/${e}`)}}var ge=Oe,ye={name:"Customer",components:{},data(){return{loaded:!1,promise:[],customers:[],customer:[],checkedItems:[],isCheckAll:!1,light:"bg-yellow-50",focusMedium:"focus:outline-none border border-gray-300 focus:border-yellow-600 focus:ring-0",exemple:"border border-gray-300 bg-white text-gray-900 appearance-none block w-full rounded-md py-3 px-4 focus:border-gray-900 focus:outline-none",medium:"bg-yellow-400",dark:"bg-yellow-600",customersMeta:[],error:"",message:"",createError:"",createErrorFlag:!1,updateError:"",updateErrorFlag:!1,edit:!1,create:!1,search:"",title:"Customers",showModal:!1,showMessage:!1,delay:3e3}},computed:{filteredCustomers(){return this.customers.filter(e=>this.testCustomer(e))}},methods:{async createCust(){var e={};this.createErrorFlag=!1,this.createError="";for(var t=0;t<this.customersMeta.length;t++){var s=this.customersMeta[t][0],r=this.getLastMeta(s);e[s]=this.$refs[r].value,"email"!==s||e[s].includes("@")||(this.createErrorFlag=!0,this.createError='E-mail should contain "@" character !')}this.createErrorFlag||(this.$refs.create.reset(),this.create=!1,await ge.insertCustomer(e),this.message="Customer created successfully!",this.showMessage=!0,this.customers=await ge.getCustomers(),this.hideAfterDelay())},async updateCust(e){var t={};this.updateErrorFlag=!1,this.updateError="",console.log("updateCust ("+e+")");for(var s=0;s<this.customersMeta.length;s++){var r=this.customersMeta[s][0],c="u_"+this.getLastMeta(r);t[r]=this.$refs[c].value,"email"!==r||t[r].includes("@")||(this.updateErrorFlag=!0,this.updateError='E-mail should contain "@" character !')}if(!this.updateErrorFlag){const s=this.customer._id;await ge.updateCustomer(s,t),e?(this.customers=await ge.getCustomers(),this.edit=!1):this.customer=await ge.getCustomer(s),this.message="Customer updated successfully!",this.showMessage=!0,this.hideAfterDelay()}},hideAfterDelay(){setTimeout(()=>{this.hideMessage()},this.delay)},getLastMeta(e){if(e.includes(".")){var t=e.split(".").length;return e.split(".")[t-1]}return e},getMeta(e,t){return e.includes(".")&&e.split(".")?t[e.split(".")[0]]?t[e.split(".")[0]][e.split(".")[1]]:"":t[e]},hideMessage(){this.showMessage=!1},editCustomer(e){this.edit||(this.edit=!0,this.customer=e)},createCustomer(){this.edit=!1,this.create=!0},showCustomerModal(e){this.customer=e,this.showModal=!0},cancel(){this.showModal=!1},cancelEdit(){this.showMessage=!1,this.message="",this.edit=!1},cancelCreate(){this.$refs.create.reset(),this.createErrorFlag=!1,this.createError="",this.create=!1},async deleteCust(e){await ge.deleteCustomer(e),this.showModal=!1,this.customers=await ge.getCustomers()},checkAll:function(){if(this.isCheckAll=!this.isCheckAll,this.checkedItems=[],this.isCheckAll)for(var e in this.customers)this.checkedItems.push(this.customers[e]._id)},updateCheckAll:function(){this.checkedItems.length===this.customers.length?this.isCheckAll=!0:this.isCheckAll=!1},testCustomer(e){var t=0,s="",r="",c="",a=!1;for(t=0;t<this.customersMeta.length;t++)s=this.customersMeta[t][0],s.includes(".")&&e[s]?(c=s.split(".")[0],r=s.split(".")[1],e[c][r]&&e[c][r].toLowerCase().includes(this.search.toLowerCase())&&(a=!0)):e[s]&&e[s].toLowerCase().includes(this.search.toLowerCase())&&(a=!0);return a}},mounted(){try{this.promise=ge.getCustomers(),this.customersMeta=ge.getCustomersMeta(),this.promise.then(e=>{this.customers=e}),this.customersMeta.then(e=>{this.customersMeta=e,this.loaded=!0})}catch(e){this.error=e.message,console.log("Customer.vue Error : "+this.error)}}};ye.render=he;var ve=ye;const we=[{path:"/",name:"Home",component:A,linkActiveClass:"active"},{path:"/customer",name:"Customer",component:ve,linkActiveClass:"active"}],xe=Object(C["a"])({history:Object(C["b"])("/"),routes:we});var Ce=xe;s("ba8c");Object(r["c"])(x).use(Ce).mount("#app")},ba8c:function(e,t,s){}});
//# sourceMappingURL=app.e938ff1c.js.map